<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-adsense-account" content="ca-pub-9239182778221521">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9239182778221521" crossorigin="anonymous"></script>
    <title>PDF से Word कन्वर्टर - ToolHub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; line-height: 1.6; background: #f0f2f5; color: #333; }
        .header { background: linear-gradient(120deg, #ff6b6b, #4ecdc4); padding: 1.5rem 2rem; position: fixed; width: 100%; top: 0; z-index: 1000; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .nav { max-width: 1300px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 2rem; font-weight: 700; color: #fff; letter-spacing: 1px; text-shadow: 0 2px 5px rgba(0,0,0,0.3); }
        .nav-links a { color: #fff; text-decoration: none; margin-left: 2.5rem; font-weight: 500; transition: color 0.3s ease; }
        .nav-links a:hover { color: #ffe66d; }
        .tool-section { max-width: 1300px; margin: 100px auto; padding: 2rem; background: #fff; border-radius: 15px; box-shadow: 0 5px 25px rgba(0,0,0,0.1); }
        .tool-section h2 { color: #1e3c72; font-size: 2rem; margin-bottom: 1.5rem; }
        .tool-section p, .tool-section ul, .tool-section ol { margin-bottom: 1rem; }
        #pdf-upload { border: 2px dashed #ccc; padding: 2rem; text-align: center; margin-bottom: 1rem; }
        #pdf-upload.dragover { background: #e1f5fe; }
        button { padding: 1rem 2rem; background: #00d4ff; color: white; border: none; border-radius: 50px; cursor: pointer; margin: 0.5rem; }
        button:hover { background: #00b7d9; }
        .ad-container { margin: 2rem auto; max-width: 100%; text-align: center; }
        #cookie-consent { position: fixed; bottom: 0; background: #333; color: #fff; padding: 10px; width: 100%; text-align: center; z-index: 1000; }
        #cookie-consent a { color: #ffe66d; }
        #cookie-consent button { background: #00d4ff; border-radius: 5px; padding: 0.5rem 1rem; }
        .footer { background: linear-gradient(120deg, #ff6b6b, #4ecdc4); color: white; padding: 3rem 2rem; margin-top: 4rem; }
        .footer-content { max-width: 1300px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 2.5rem; }
        .footer h4 { margin-bottom: 1.5rem; font-size: 1.3rem; }
        .footer p { opacity: 0.9; transition: opacity 0.3s ease; }
        .footer p:hover { opacity: 1; }
        #error-message { color: red; display: none; margin-top: 1rem; }
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .tool-section { margin: 80px 1rem; padding: 1rem; }
            .footer-content { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <header class="header">
        <nav class="nav">
            <div class="logo">ToolHub</div>
            <div class="nav-links">
                <a href="index.html">होम</a>
                <a href="index.html#tools">टूल्स</a>
                <a href="index.html#about">अबाउट</a>
                <a href="index.html#contact">कॉन्टैक्ट</a>
                <a href="privacy-policy.html">प्राइवेसी पॉलिसी</a>
                <a href="terms.html">टर्म्स ऑफ सर्विस</a>
            </div>
        </nav>
    </header>
    <main>
        <section class="tool-section">
            <h2>PDF से Word कन्वर्टर टूल</h2>
            <p>ToolHub का PDF से Word कन्वर्टर टूल आपको PDF फाइलों को Microsoft Word (.docx) दस्तावेज़ में बदलने की सुविधा देता है। यह टूल हिंदी टेक्स्ट, पैराग्राफ, और बुनियादी स्वरूपण को संरक्षित करता है, जिससे आप Word में आसानी से संपादन कर सकते हैं। यह स्टूडेंट्स, प्रोफेशनल्स, और व्यवसायों के लिए आदर्श है।</p>
            <p>हमारा टूल PDF से टेक्स्ट निकालता है और उसे संपादन योग्य Word फाइल में बदलता है। यह सुरक्षित है और आपकी फाइलें सर्वर पर स्टोर नहीं की जातीं। <strong>नोट:</strong> केवल टेक्स्ट-आधारित PDF समर्थित हैं। स्कैन की गई PDF काम नहीं करेंगी।</p>
            <h3>कैसे उपयोग करें?</h3>
            <ol>
                <li>नीचे दिए गए क्षेत्र में अपनी PDF फाइल ड्रैग करें या "फाइल चुनें" पर क्लिक करें (अधिकतम 10MB)।</li>
                <li>"कन्वर्ट" बटन पर क्लिक करें।</li>
                <li>रूपांतरित Word फाइल (.docx) डाउनलोड करें।</li>
            </ol>
            <h3>फायदे</h3>
            <ul>
                <li>हिंदी टेक्स्ट और बुनियादी स्वरूपण का सटीक रूपांतरण।</li>
                <li>कोई सॉफ्टवेयर इंस्टॉलेशन की आवश्यकता नहीं।</li>
                <li>सुरक्षित और मुफ्त उपयोग।</li>
                <li>मोबाइल और डेस्कटॉप पर उपयोग में आसान।</li>
            </ul>
            <h3>उदाहरण</h3>
            <p>मान लीजिए आपके पास एक PDF है जिसमें हिंदी में लेक्चर नोट्स हैं। हमारे टूल से आप इसे Word में बदल सकते हैं, जहाँ टेक्स्ट संपादन योग्य होगा। यह शिक्षकों और स्टूडेंट्स के लिए समय बचाने वाला है।</p>
            <div id="pdf-upload">
                <p>PDF फाइल यहाँ ड्रैग करें या अपलोड करें</p>
                <input type="file" id="pdfInput" accept="application/pdf">
            </div>
            <button id="convertButton">कन्वर्ट करें</button>
            <p id="error-message"></p>
        </section>
        <div class="ad-container">
            <ins class="adsbygoogle"
                 style="display:block"
                 data-ad-client="ca-pub-9239182778221521"
                 data-ad-slot="7274852761"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
        </div>
        
        <div class="faq-section">
            <h3>Frequently Asked Questions</h3>
            <p><strong>Q: What types of PDF files can be converted?</strong></p>
            <p>A: Our PDF to Word converter works best with text-based PDF files. Scanned PDFs or image-based PDFs may not convert accurately as they require OCR technology.</p>
            
            <p><strong>Q: Is there a file size limit?</strong></p>
            <p>A: Yes, we recommend PDF files up to 10MB for optimal performance. Larger files may take longer to process or may be rejected.</p>
            
            <p><strong>Q: Will the formatting be preserved?</strong></p>
            <p>A: We strive to maintain basic formatting including paragraphs, headings, and simple layouts. Complex formatting, tables, and images may not transfer perfectly.</p>
            
            <p><strong>Q: Can I convert Hindi or other Indian language PDFs?</strong></p>
            <p>A: Yes, our tool supports Hindi and other Indian languages. However, the quality depends on the PDF's text encoding and font embedding.</p>
            
            <p><strong>Q: Is my PDF file stored on your servers?</strong></p>
            <p>A: No, your files are processed securely and are not stored on our servers after conversion is complete. Your privacy is our priority.</p>
        </div>
    </main>
    <footer class="footer">
        <div class="footer-content">
            <div>
                <h4>ToolHub</h4>
                <p>आपका अंतिम डिजिटल टूलकिट</p>
            </div>
            <div>
                <h4>टूल्स</h4>
                <p><a href="img-compress.html" style="color: white; text-decoration: none;">इमेज टूल्स</a></p>
                <p><a href="pdf-to-word.html" style="color: white; text-decoration: none;">PDF टूल्स</a></p>
                <p><a href="video-converter.html" style="color: white; text-decoration: none;">वीडियो टूल्स</a></p>
                <p><a href="voice-translator.html" style="color: white; text-decoration: none;">वॉयस टूल्स</a></p>
                <p><a href="doc-format-converter.html" style="color: white; text-decoration: none;">डॉक्यूमेंट टूल्स</a></p>
                <p><a href="multifunction-calculator.html" style="color: white; text-decoration: none;">कैलकुलेटर टूल्स</a></p>
                <p><a href="passport-size-photo-maker.html" style="color: white; text-decoration: none;">पासपोर्ट फोटो टूल्स</a></p>
            </div>
            <div>
                <h4>सपोर्ट</h4>
                <p><a href="index.html#contact" style="color: white; text-decoration: none;">कॉन्टैक्ट अस</a></p>
                <p><a href="#faq" style="color: white; text-decoration: none;">FAQ</a></p>
                <p><a href="#docs" style="color: white; text-decoration: none;">डॉक्यूमेंटेशन</a></p>
            </div>
            <div>
                <h4>कानूनी</h4>
                <p><a href="privacy-policy.html" style="color: white; text-decoration: none;">प्राइवेसी पॉलिसी</a></p>
                <p><a href="terms.html" style="color: white; text-decoration: none;">टर्म्स ऑफ सर्विस</a></p>
            </div>
        </div>
    </footer>
    <div id="cookie-consent">
        <p>हम कुकीज़ का उपयोग विज्ञापन और एनालिटिक्स के लिए करते हैं। <a href="privacy-policy.html">और जानें</a></p>
        <button onclick="document.getElementById('cookie-consent').style.display='none';">सहमत</button>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.0/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://unpkg.com/pizzip@3.1.7/dist/pizzip.min.js"></script>
    <script src="https://unpkg.com/docxtemplater@3.31.1/build/docxtemplater.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.14.0/pdf.worker.min.js';
        const pdfUpload = document.getElementById('pdf-upload');
        const pdfInput = document.getElementById('pdfInput');
        const errorMessage = document.getElementById('error-message');
        const convertButton = document.getElementById('convertButton');
        let isProcessing = false;

        function showError(message) {
            errorMessage.style.display = 'block';
            errorMessage.textContent = message;
            console.error(message);
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        pdfUpload.addEventListener('dragover', (e) => {
            e.preventDefault();
            pdfUpload.classList.add('dragover');
        });

        pdfUpload.addEventListener('dragleave', () => {
            pdfUpload.classList.remove('dragover');
        });

        pdfUpload.addEventListener('drop', debounce((e) => {
            e.preventDefault();
            pdfUpload.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file && file.type === 'application/pdf' && file.name.endsWith('.pdf')) {
                pdfInput.files = [file];
                handleFile(file);
            } else {
                showError('कृपया केवल वैध PDF फाइल अपलोड करें।');
            }
        }, 300));

        pdfInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file && file.type === 'application/pdf' && file.name.endsWith('.pdf')) {
                handleFile(file);
            } else {
                showError('कृपया केवल वैध PDF फाइल अपलोड करें।');
                e.target.value = '';
            }
        });

        let pdfText = '';

        function handleFile(file) {
            if (isProcessing) return;
            isProcessing = true;
            if (file.size > 10 * 1024 * 1024) {
                showError('फाइल का आकार 10MB से कम होना चाहिए।');
                isProcessing = false;
                return;
            }
            const reader = new FileReader();
            reader.onload = async function(e) {
                try {
                    console.log('Processing PDF file:', file.name);
                    const typedArray = new Uint8Array(e.target.result);
                    const pdf = await pdfjsLib.getDocument({ data: typedArray, disableFontFace: true }).promise;
                    pdfText = '';
                    for (let i = 1; i <= pdf.numPages; i++) {
                        const page = await pdf.getPage(i);
                        const textContent = await page.getTextContent();
                        let pageText = textContent.items
                            .filter(item => item.str && item.str.trim())
                            .map(item => item.str)
                            .join(' ');
                        const lines = pageText.split('\n').filter(line => line.trim());
                        const filteredLines = lines.filter(line => {
                            const trimmed = line.trim();
                            const spaceCount = (trimmed.match(/\s+/g) || []).length;
                            const isNumberHeavy = trimmed.match(/\d+/g) && trimmed.match(/\d+/g).length > 3;
                            return spaceCount < 5 || !isNumberHeavy;
                        });
                        pdfText += filteredLines.join(' ') + '\n\n';
                    }
                    pdfText = pdfText.trim();
                    console.log('PDF text extracted:', pdfText.substring(0, 100) + '...');
                    if (!pdfText) {
                        pdfText = 'PDF में टेक्स्ट नहीं मिला। कृपया टेक्स्ट-आधारित PDF अपलोड करें।';
                        console.warn('No text extracted. Generating minimal DOCX.');
                    }
                    errorMessage.style.display = 'none';
                } catch (err) {
                    showError('PDF प्रोसेसिंग में त्रुटि: ' + err.message + '। कृपया टेक्स्ट-आधारित PDF अपलोड करें।');
                    console.error('PDF processing error:', err);
                    pdfText = 'PDF में टेक्स्ट नहीं मिला।';
                } finally {
                    isProcessing = false;
                    pdfInput.value = '';
                }
            };
            reader.onerror = () => {
                showError('फाइल पढ़ने में त्रुटि।');
                isProcessing = false;
                pdfInput.value = '';
            };
            reader.readAsArrayBuffer(file);
        }

        function convertToWord() {
            if (!pdfText) {
                showError('कृपया पहले वैध PDF फाइल अपलोड करें।');
                return;
            }
            try {
                console.log('Starting DOCX conversion...');
                if (typeof PizZip === 'undefined') {
                    throw new Error('PizZip लाइब्रेरी लोड नहीं हुई। कृपया पेज रिफ्रेश करें या AdBlock अक्षम करें।');
                }
                if (typeof docxtemplater === 'undefined') {
                    throw new Error('docxtemplater लाइब्रेरी लोड नहीं हुई। कृपया पेज रिफ्रेश करें या AdBlock अक्षम करें।');
                }

                const zip = new PizZip();
                const paragraphs = pdfText.split('\n\n').filter(p => p.trim());
                let xmlContent = '';
                paragraphs.forEach(paragraph => {
                    const escapedText = paragraph.replace(/[<>%&"']/g, char => ({
                        '<': '&lt;',
                        '>': '&gt;',
                        '&': '&amp;',
                        '"': '&quot;',
                        '%': '&#37;',
                        "'": '&apos;'
                    })[char]);
                    xmlContent += `
                        <w:p>
                            <w:r>
                                <w:rPr>
                                    <w:rFonts w:ascii="Noto Sans Devanagari" w:hAnsi="Noto Sans Devanagari" w:cs="Noto Sans Devanagari"/>
                                    <w:sz w:val="24"/>
                                </w:rPr>
                                <w:t xml:space="preserve"><![CDATA[${escapedText}]]></w:t>
                            </w:r>
                        </w:p>`;
                });

                if (!xmlContent) {
                    xmlContent = `
                        <w:p>
                            <w:r>
                                <w:rPr>
                                    <w:rFonts w:ascii="Noto Sans Devanagari" w:hAnsi="Noto Sans Devanagari" w:cs="Noto Sans Devanagari"/>
                                    <w:sz w:val="24"/>
                                </w:rPr>
                                <w:t xml:space="preserve"><![CDATA[${pdfText}]]></w:t>
                            </w:r>
                        </w:p>`;
                }

                const content = `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
                    <w:document xmlns:w="http://schemas.openxmlformats.org/wordprocessingml/2006/main">
                        <w:body>
                            ${xmlContent}
                        </w:body>
                    </w:document>`;

                zip.file('word/document.xml', content);
                zip.file('[Content_Types].xml', `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
                    <Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">
                        <Default Extension="xml" ContentType="application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml"/>
                        <Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>
                    </Types>`);
                zip.file('_rels/.rels', `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
                    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
                        <Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="word/document.xml"/>
                    </Relationships>`);
                zip.file('word/_rels/document.xml.rels', `<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
                    <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"></Relationships>`);

                console.log('ZIP structure created, loading into docxtemplater...');
                const doc = new docxtemplater(zip, { paragraphLoop: true, linebreaks: true });
                console.log('Generating DOCX...');
                const output = doc.getZip().generate({
                    type: 'blob',
                    mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
                });
                console.log('DOCX generated, initiating download...');
                const link = document.createElement('a');
                link.href = URL.createObjectURL(output);
                link.download = 'converted-document.docx';
                link.click();
                errorMessage.style.display = 'none';
            } catch (err) {
                showError('Word दस्तावेज़ बनाने में त्रुटि: ' + err.message);
                console.error('Detailed error:', err);
            }
        }

        convertButton.addEventListener('click', convertToWord);
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Passport Size Photo Maker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/face-api.js/1.3.0/face-api.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; }
        .container { max-width: 600px; margin: auto; }
        canvas { display: block; margin: auto; border: 1px solid black; }
        #outputContainer { display: flex; flex-wrap: wrap; justify-content: center; }
        .photo-frame { margin: 5px; border: 2px solid black; padding: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Passport Size Photo Maker</h2>
        <input type="file" id="imageUpload" accept="image/*">
        <select id="backgroundColor">
            <option value="white">White</option>
            <option value="blue">Blue</option>
            <option value="red">Red</option>
        </select>
        <select id="photoCount">
            <option value="1">1 Photo</option>
            <option value="4">4 Photos</option>
            <option value="6">6 Photos</option>
            <option value="8">8 Photos</option>
        </select>
        <button onclick="processPhoto()">Generate</button>
        <div id="outputContainer"></div>
    </div>

    <script>
        async function processPhoto() {
            const input = document.getElementById('imageUpload').files[0];
            if (!input) return alert('Please upload an image');
            
            const img = new Image();
            img.src = URL.createObjectURL(input);
            img.onload = async () => {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = 600;
                canvas.height = 800;
                ctx.drawImage(img, 0, 0, 600, 800);
                
                await faceapi.nets.ssdMobilenetv1.loadFromUri('/models');
                const detections = await faceapi.detectSingleFace(canvas);
                if (!detections) return alert('Front face not detected!');
                
                const bgColor = document.getElementById('backgroundColor').value;
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 50, 50, 500, 700);
                
                generatePhotoSet(canvas);
            };
        }

        function generatePhotoSet(canvas) {
            const count = document.getElementById('photoCount').value;
            const outputContainer = document.getElementById('outputContainer');
            outputContainer.innerHTML = '';
            
            for (let i = 0; i < count; i++) {
                const photo = document.createElement('canvas');
                photo.width = 300;
                photo.height = 400;
                const ctx = photo.getContext('2d');
                ctx.drawImage(canvas, 0, 0, 300, 400);
                ctx.strokeStyle = 'black';
                ctx.lineWidth = 5;
                ctx.strokeRect(0, 0, 300, 400);
                photo.classList.add('photo-frame');
                outputContainer.appendChild(photo);
            }
        }
    </script>
</body>
</html>
